<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="utf-8"/>
  <title>Holiday Leave (HL) Availability Calculator</title>
  <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;600&display=swap" rel="stylesheet"/>
  <style>
    body {
      font-family: 'Inter', sans-serif;
      background-color: #f9f9fb;
      color: #333;
      margin: 2rem;
    }
    h2 { color: #003366; }
    label { font-weight: 600; }
    input, select, button {
      padding: 8px;
      margin: 6px 0;
      width: 100%;
      max-width: 300px;
      box-sizing: border-box;
      border: 1px solid #ccc;
      border-radius: 6px;
      font-family: 'Inter', sans-serif;
    }
    button {
      background-color: #005ea2;
      color: white;
      cursor: pointer;
      transition: background-color 0.3s ease;
    }
    button:hover { background-color: #004080; }
    .result {
      margin-top: 1rem;
      padding: 10px;
      border-radius: 5px;
      background-color: #e6f4ea;
      color: #0b5133;
      border: 1px solid #a4d4ae;
      max-width: 600px;
    }
    table {
      width: 100%;
      margin-top: 2rem;
      border-collapse: collapse;
      background: white;
      box-shadow: 0 2px 6px rgba(0,0,0,0.05);
    }
    th, td {
      text-align: center;
      padding: 12px;
      border-bottom: 1px solid #ddd;
    }
    th { background-color: #f0f4f8; }
    .available { color: green; font-weight: 600; }
    .not-available { color: red; font-weight: 600; }
    .previously-applied { color: #d7191c; font-weight: 600; }
    .blue-text { color: #0070d2; font-weight: bold; }
    .red-text { color: #d7191c; font-weight: bold; }
    .green-text { color: #1a9850; font-weight: bold; }
    .black-text { color: #000; font-weight: bold; }
    .vl-green { color: #1a9850; font-weight: bold; }
    .vl-red { color: #d7191c; font-weight: bold; }
  </style>
</head>
<body>
  <h2>Holiday Leave (HL) Availability Calculator</h2>

  <label for="fte">Select your FTE:</label>
  <select id="fte">
    <option value="0.50">0.50</option>
    <option value="0.60-nw">0.60 (non-WEPP)</option>
    <option value="0.75">0.75</option>
    <option value="0.90">0.90</option>
    <option value="1.00">1.00</option>
  </select><br/>

  <label for="checkDate">Enter the date you're checking:</label>
  <input id="checkDate" type="date"/><br/>

  <label for="hlBalance">Enter your current HL balance as of that date:</label>
  <input id="hlBalance" type="number" value="0"/><br/>

  <label for="vlBalance">Enter your Vacation Leave (VL) balance at checked date:</label>
  <input id="vlBalance" type="number" value="0"/><br/>

  <label for="employmentStatus">Was the employee employed before October 20, 2025?</label>
  <select id="employmentStatus">
    <option value="yes">Yes</option>
    <option value="no">No</option>
  </select><br/>

  <button onclick="calculateHL()">Calculate</button>
  <button onclick="location.reload()">Reset</button>

  <div id="output"></div>

  <table id="holidayTable">
    <thead>
      <tr>
        <th>Holiday</th>
        <th>Date Observed</th>
        <th>Loaded to UKG</th>
        <th>Date Available if VL Not Sufficient</th>
        <th>Status</th>
        <th>Amount of Hours Loaded</th>
        <th>Used</th>
        <th>Remaining</th>
        <th>VL Hours Needed to Advance HL</th>
      </tr>
    </thead>
    <tbody id="holidayTableBody"></tbody>
  </table>

<script>
function calculateHL() {
  const fteInput = document.getElementById("fte");
  const dateInput = document.getElementById("checkDate");
  const hlBalanceInput = parseFloat(document.getElementById("hlBalance").value) || 0;
  const vlBalance = parseFloat(document.getElementById("vlBalance").value) || 0;
  const employedBeforeCutoff = document.getElementById("employmentStatus").value === "yes";

  let fte = parseFloat(fteInput.value);
  if (fteInput.value === "0.60-nw") fte = 0.60;

  const workdayHours = fte * 8;
  const advanceVLNeeded = 3 * workdayHours;

  const checkDate = new Date(dateInput.value + "T00:00:00");
  let earlyUsesAllowed = Math.floor(vlBalance / advanceVLNeeded);

  const holidays = [
    { name:'Independence Day',dateObserved:'2025-07-04',ukgDate:'2025-05-18',firstAvailable:'2025-06-29' },
    { name:'Labor Day',dateObserved:'2025-09-01',ukgDate:'2025-07-13',firstAvailable:'2025-08-24' },
    { name:'Thanksgiving Day',dateObserved:'2025-11-27',ukgDate:'2025-10-20',firstAvailable:'2025-11-16' },
    { name:'Day After Thanksgiving',dateObserved:'2025-11-28',ukgDate:'2025-10-20',firstAvailable:'2025-11-16' },
    { name:'Christmas Eve',dateObserved:'2025-12-24',ukgDate:'2025-10-20',firstAvailable:'2025-12-14' },
    { name:'Christmas Day',dateObserved:'2025-12-25',ukgDate:'2025-10-20',firstAvailable:'2025-12-14' },
    { name:'Day After Christmas',dateObserved:'2025-12-26',ukgDate:'2025-10-20',firstAvailable:'2025-12-15' },
    { name:'Bonus Day 1',dateObserved:'2025-12-29',ukgDate:'2025-10-20',firstAvailable:'2025-12-16' },
    { name:'Bonus Day 2',dateObserved:'2025-12-30',ukgDate:'2025-10-20',firstAvailable:'2025-12-17' },
    { name:'Bonus Day 3',dateObserved:'2025-12-31',ukgDate:'2025-10-20',firstAvailable:'2025-12-18' },
    { name:"New Year's Day",dateObserved:'2026-01-01',ukgDate:'2025-10-20',firstAvailable:'2025-12-19' },
    { name:"Day After New Year's",dateObserved:'2026-01-02',ukgDate:'2025-10-20',firstAvailable:'2025-12-20' },
    { name:"Martin Luther King Jr. Day",dateObserved:'2026-01-19',ukgDate:'2025-11-30',firstAvailable:'2026-01-09' },
    { name:"Memorial Day",dateObserved:'2026-05-25',ukgDate:'2026-04-05',firstAvailable:'2026-05-15' },
    { name:"Juneteenth",dateObserved:'2026-06-19',ukgDate:'2026-04-05',firstAvailable:'2026-06-09' }
  ];

  holidays.sort((a,b)=>new Date(a.dateObserved)-new Date(b.dateObserved));

  let hlTotalLoaded = 0;
  let adjustedHLBalance = hlBalanceInput;
  let tempUsed = 0;
  let loadedHolidays = [];

  holidays.forEach(h=>{
    const ukg = new Date(h.ukgDate+"T00:00:00");
    const restricted = ['Independence Day','Labor Day','Christmas Eve','Day After Christmas','Bonus Day 1','Bonus Day 2','Bonus Day 3','Day After New Year\'s'];
    if (!employedBeforeCutoff && restricted.includes(h.name)) return;
    if (checkDate >= ukg) {
      loadedHolidays.push(h);
      hlTotalLoaded += workdayHours;
    }
  });

  if (checkDate > new Date()) {
    holidays.forEach(h => {
      const ukg = new Date(h.ukgDate + "T00:00:00");
      if (checkDate >= ukg && new Date() < ukg) {
        adjustedHLBalance += workdayHours;
      }
    });
  }

  let hlUsed = hlTotalLoaded - adjustedHLBalance;
  tempUsed = hlUsed;

  let earliestUnavailableVLShown = false;
  let totalRemainingAvailableHL = 0;

  const outputRows = loadedHolidays.map(holiday => {
    const observed = new Date(holiday.dateObserved+"T00:00:00");
    const ukg = new Date(holiday.ukgDate+"T00:00:00");
    const firstAvail = new Date(holiday.firstAvailable+"T00:00:00");
    let loaded = workdayHours;
    let used = 0;
    let remaining = 0;
    let status = "Not Available";
    let vlNeededDisplay = "";
    let vlClass = "black-text";

    if (tempUsed >= loaded) {
      status = "Previously Applied";
      used = loaded;
      remaining = 0;
      tempUsed -= loaded;
    } else {
      used = Math.min(tempUsed, loaded);
      remaining = loaded - used;
      tempUsed = Math.max(tempUsed - loaded, 0);
      const canAdvanceEarly = earlyUsesAllowed > 0;
      const pastFirstAvail = checkDate >= firstAvail;

      if (pastFirstAvail) {
        status = "Available";
        vlNeededDisplay = "";
        totalRemainingAvailableHL += remaining;
      } else if (canAdvanceEarly) {
        status = "Available";
        vlNeededDisplay = advanceVLNeeded.toFixed(2);
        vlClass = "vl-green";
        earlyUsesAllowed--;
        totalRemainingAvailableHL += remaining;
      } else {
        status = "Not Available";
        used = 0;
        remaining = 0;
        if (!pastFirstAvail && !earliestUnavailableVLShown) {
          vlNeededDisplay = advanceVLNeeded.toFixed(2);
          earliestUnavailableVLShown = true;
          vlClass = "vl-red";
        }
      }
    }

    return `
      <tr>
        <td>${holiday.name}</td>
        <td>${observed.toLocaleDateString()}</td>
        <td>${ukg.toLocaleDateString()}</td>
        <td>${firstAvail.toLocaleDateString()}</td>
        <td class="${status==='Available'?'available':status==='Previously Applied'?'previously-applied':'not-available'}">${status}</td>
        <td class="blue-text">${loaded.toFixed(2)}</td>
        <td class="${used>0?'red-text':'black-text'}">${used.toFixed(2)}</td>
        <td class="${remaining>0?'green-text':'black-text'}">${remaining.toFixed(2)}</td>
        <td class="${vlClass}">${vlNeededDisplay}</td>
      </tr>
    `;
  });

  document.getElementById("holidayTableBody").innerHTML = outputRows.join("");

  const formattedCheckDate = checkDate.toLocaleDateString();
  document.getElementById("output").innerHTML = `
    <div class="result">
      âœ… <strong>Total HL hours loaded into UKG by this date:</strong> ${hlTotalLoaded.toFixed(2)} hrs<br/>
      ðŸ’¡ <strong>Based on your balance of ${hlBalanceInput.toFixed(2)} hrs, adjusted for future loaded holidays, you have used:</strong> ${hlUsed.toFixed(2)} hrs<br/><br/>
      ðŸŸ© <strong>Total Remaining Available HL Hours as of ${formattedCheckDate}:</strong> ${totalRemainingAvailableHL.toFixed(2)} hrs
    </div>
  `;
}
</script>

</body>
</html>
